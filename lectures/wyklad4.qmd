---
title: "WYKÅAD 4 â€“ Podstawy PL/SQL, transakcje i indeksy"
---

## ğŸ¯ Temat: Programowanie w PL/SQL i podstawy optymalizacji

Celem wykÅ‚adu jest wprowadzenie do **jÄ™zyka proceduralnego PL/SQL**, pokazanie zasad **przetwarzania transakcyjnego** w bazach danych oraz omÃ³wienie roli **indeksÃ³w** w przyspieszaniu wyszukiwania danych.

---

## ğŸ§  Cele wykÅ‚adu

Student po wykÅ‚adzie bÄ™dzie potrafiÅ‚:

- zrozumieÄ‡ rÃ³Å¼nice miÄ™dzy SQL a PL/SQL,  
- pisaÄ‡ proste bloki PL/SQL do operowania na danych,  
- zarzÄ…dzaÄ‡ transakcjami (commit, rollback),  
- rozumieÄ‡ rolÄ™ i zasady tworzenia indeksÃ³w w bazie danych.

---

## 1ï¸âƒ£ Wprowadzenie do PL/SQL

### ğŸ”¹ Czym jest PL/SQL?

- PL/SQL to **proceduralny jÄ™zyk rozszerzajÄ…cy SQL** w systemach Oracle i kompatybilnych.  
- UmoÅ¼liwia uÅ¼ycie **instrukcji warunkowych, pÄ™tli, zmiennych i procedur**, czego SQL nie oferuje w formie deklaratywnej.  

**PrzykÅ‚ad prostego bloku PL/SQL:**

```sql
BEGIN
    DBMS_OUTPUT.PUT_LINE('Witaj w Å›wiecie PL/SQL!');
END;
/
```

Kod ten uruchamia blok proceduralny, ktÃ³ry wypisuje komunikat. 

BEGIN rozpoczyna blok, END; koÅ„czy, a / uruchamia go w SQL*Plus.

### ğŸ”¹ Zmienne i typy danych

PL/SQL pozwala tworzyÄ‡ zmienne i przypisywaÄ‡ im wartoÅ›ci.

```sql
DECLARE
    v_imie VARCHAR2(50);
    v_wiek NUMBER;
BEGIN
    v_imie := 'Jan';
    v_wiek := 25;
    DBMS_OUTPUT.PUT_LINE('Student: ' || v_imie || ', wiek: ' || v_wiek);
END;
/
```

Zmienne umoÅ¼liwiajÄ… przechowywanie danych tymczasowo w trakcie wykonywania programu.

### ğŸ”¹ Instrukcje warunkowe i pÄ™tle

PL/SQL pozwala na uÅ¼ycie:

- IFâ€¦THENâ€¦ELSE:

```sql
IF v_wiek >= 18 THEN
    DBMS_OUTPUT.PUT_LINE('PeÅ‚noletni');
ELSE
    DBMS_OUTPUT.PUT_LINE('NiepeÅ‚noletni');
END IF;
```

- LOOP, WHILE, FOR â€“ do powtarzania operacji:
```sql
FOR i IN 1..5 LOOP
    DBMS_OUTPUT.PUT_LINE('Liczba: ' || i);
END LOOP;
```

Instrukcje warunkowe i pÄ™tle pozwalajÄ… w peÅ‚ni programowaÄ‡ logikÄ™ w bazie danych.

## 2ï¸âƒ£ Operacje na danych w PL/SQL

PL/SQL umoÅ¼liwia wykonywanie standardowych operacji SQL:

- INSERT, UPDATE, DELETE â€“ bezpoÅ›rednio w blokach proceduralnych.

PrzykÅ‚ad aktualizacji studenta:

```sql
BEGIN
    UPDATE Studenci
    SET Wiek = 26
    WHERE NrIndeksu = 12345;
END;
/
```

moÅ¼na grupowaÄ‡ wiele operacji w jednym bloku, co uÅ‚atwia zarzÄ…dzanie spÃ³jnoÅ›ciÄ… danych.

## 3ï¸âƒ£ Przetwarzanie transakcyjne

### ğŸ”¹ Co to jest transakcja?

Transakcja to jednostka pracy w bazie danych, ktÃ³ra:

- wykonuje kilka operacji jako caÅ‚oÅ›Ä‡,
- jest atomowa â€“ albo wszystkie operacje siÄ™ powiodÄ…, albo Å¼adna,
- zapewnia spÃ³jnoÅ›Ä‡ danych (ACID).

### ğŸ”¹ Polecenia transakcyjne

- COMMIT â€“ zatwierdza wszystkie zmiany wykonane w transakcji.
- ROLLBACK â€“ wycofuje wszystkie zmiany od ostatniego commit.
- SAVEPOINT â€“ pozwala ustawiÄ‡ punkt czÄ™Å›ciowego cofniÄ™cia.

PrzykÅ‚ad uÅ¼ycia transakcji:
```sql
BEGIN
    INSERT INTO Studenci VALUES(12346, 'Anna', 'Kowalska', 21);
    UPDATE Kursy SET IloscMiejsc = IloscMiejsc - 1 WHERE KursID = 10;
    COMMIT;
END;
/

```
obie operacje â€“ wstawienie studenta i zmniejszenie liczby miejsc â€“ zostanÄ… zatwierdzone jednoczeÅ›nie. JeÅ›li jedna siÄ™ nie powiedzie, moÅ¼na uÅ¼yÄ‡ ROLLBACK, aby przywrÃ³ciÄ‡ stan poprzedni.

## 4ï¸âƒ£ Indeksy w bazie danych

### ğŸ”¹ Co to jest indeks?

- Indeks to struktura danych, ktÃ³ra przyspiesza wyszukiwanie rekordÃ³w w tabeli.
- DziaÅ‚a podobnie jak spis treÅ›ci w ksiÄ…Å¼ce.

PrzykÅ‚ad tworzenia indeksu:
```sql
CREATE INDEX idx_studenci_nazwisko
ON Studenci(Nazwisko);
```

ndeks przyspiesza wyszukiwanie po kolumnie Nazwisko.
Nie zawsze kaÅ¼dy indeks jest potrzebny â€“ zbyt wiele indeksÃ³w spowalnia operacje INSERT/UPDATE/DELETE.

### ğŸ”¹ Rodzaje indeksÃ³w

- Jedno-kolumnowe â€“ indeks na jednej kolumnie.
- Wielokolumnowe (composite) â€“ indeks na kilku kolumnach razem.
- Unikalne â€“ zapewniajÄ… unikalnoÅ›Ä‡ wartoÅ›ci w kolumnie.

DobÃ³r indeksÃ³w wymaga analizy typowych zapytaÅ„ w systemie, aby zwiÄ™kszyÄ‡ wydajnoÅ›Ä‡.