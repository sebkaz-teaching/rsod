---
title: "Model relacyjny i podstawy SQL"
---

# ğŸ’¾ Model relacyjny i podstawy SQL

---

## 1ï¸âƒ£ Model relacyjny â€“ przypomnienie i pojÄ™cia podstawowe

### ğŸ”¹ Relacja = tabela

- Dane przechowywane sÄ… w **tabelach** (ang. *relations*).  
- KaÅ¼dy **wiersz (row)** to rekord / krotka.  
- KaÅ¼da **kolumna (column)** to atrybut.  
- **Dziedzina (domain)** to zbiÃ³r dopuszczalnych wartoÅ›ci w danej kolumnie.

PrzykÅ‚ad relacji **STUDENT**:

| id | imie | nazwisko | rok_urodzenia |
|----|------|-----------|---------------|
| 1  | Adam | Mickiewicz | 1798 |
| 2  | Henryk | Sienkiewicz | 1846 |

> <img> Schemat relacji: tabela STUDENT z kolumnami i wierszami

---

## 2ï¸âƒ£ Klucze i wiÄ™zy integralnoÅ›ci

### ğŸ”¸ Klucz gÅ‚Ã³wny (PRIMARY KEY)
- Unikalnie identyfikuje kaÅ¼dy wiersz w tabeli.  
- Nie moÅ¼e przyjmowaÄ‡ wartoÅ›ci `NULL`.  
- W tabeli moÅ¼e wystÄ™powaÄ‡ tylko jeden klucz gÅ‚Ã³wny.

### ğŸ”¸ Klucz obcy (FOREIGN KEY)
- Tworzy powiÄ…zanie z innÄ… tabelÄ….  
- Wymusza spÃ³jnoÅ›Ä‡ danych â€“ nie moÅ¼na wprowadziÄ‡ wartoÅ›ci, ktÃ³rej nie ma w tabeli nadrzÄ™dnej.

### ğŸ”¸ Inne wiÄ™zy integralnoÅ›ci
- `UNIQUE` â€“ zapewnia unikalnoÅ›Ä‡ wartoÅ›ci w kolumnie.  
- `NOT NULL` â€“ kolumna nie moÅ¼e przyjmowaÄ‡ wartoÅ›ci pustych.  
- `CHECK` â€“ sprawdza warunek logiczny (np. `wiek > 0`).  

| Rodzaj klucza | Opis | PrzykÅ‚ad |
|----------------|------|----------|
| **Klucz gÅ‚Ã³wny (Primary Key)** | jednoznacznie identyfikuje rekord | `NrIndeksu` w `STUDENT` |
| **Klucz obcy (Foreign Key)** | tworzy powiÄ…zanie miÄ™dzy tabelami | `KursID` w tabeli `ZAPIS` |
| **Klucz kandydujÄ…cy (Candidate Key)** | atrybut, ktÃ³ry moÅ¼e byÄ‡ kluczem gÅ‚Ã³wnym | `PESEL`, `NrIndeksu` |
| **Klucz zÅ‚oÅ¼ony (Composite Key)** | skÅ‚ada siÄ™ z kilku kolumn | `(StudentID, KursID)` |

> <img> Schemat: klucz gÅ‚Ã³wny i klucz obcy miÄ™dzy tabelami STUDENT, KURS, ZAPIS

---

## 3ï¸âƒ£ Rodzaje zwiÄ…zkÃ³w (relacji) miÄ™dzy tabelami

W relacyjnych bazach danych tabele Å‚Ä…czy siÄ™ przez **klucze obce**.  
Na tej podstawie tworzÄ… siÄ™ rÃ³Å¼ne typy relacji:

| Typ relacji | Opis | PrzykÅ‚ad |
|--------------|------|----------|
| **1:1 (jeden do jednego)** | jeden rekord w tabeli A odpowiada dokÅ‚adnie jednemu rekordowi w tabeli B | Student â†”ï¸ Legitymacja |
| **1:N (jeden do wielu)** | jeden rekord w tabeli A moÅ¼e byÄ‡ powiÄ…zany z wieloma rekordami w tabeli B | WykÅ‚adowca â†”ï¸ Kursy |
| **N:M (wielu do wielu)** | wiele rekordÃ³w w A moÅ¼e byÄ‡ powiÄ…zanych z wieloma w B | Studenci â†”ï¸ Kursy |

RelacjÄ™ **N:M** realizuje siÄ™ przez **tabelÄ™ poÅ›redniczÄ…cÄ…**, np.:

```sql
STUDENT (NrIndeksu, Imie, Nazwisko)
KURS (KursID, Nazwa)
ZAPIS (NrIndeksu, KursID, DataZapisu)
```

Tabela ZAPIS zawiera klucze obce wskazujÄ…ce na STUDENT i KURS.

 <img alt="Schemat: STUDENT â€”< ZAPIS >â€” KURS (relacja N:M)">

 ## 4ï¸âƒ£ Wprowadzenie do jÄ™zyka SQL (Structured Query Language)

SQL to standardowy jÄ™zyk do definiowania, modyfikowania i pobierania danych w relacyjnych bazach danych.

| PodjÄ™zyk | Opis | PrzykÅ‚ady poleceÅ„ |
|-----------|------|-------------------|
| **DDL (Data Definition Language)** | definiuje strukturÄ™ bazy | `CREATE TABLE`, `ALTER TABLE`, `DROP TABLE` |
| **DML (Data Manipulation Language)** | operacje na danych | `INSERT`, `UPDATE`, `DELETE`, `SELECT` |
| **DCL (Data Control Language)** | kontrola dostÄ™pu | `GRANT`, `REVOKE` |
| **TCL (Transaction Control Language)** | kontrola transakcji | `COMMIT`, `ROLLBACK` |

---

### ğŸ”¹ Tworzenie tabel (DDL â€“ Data Definition Language)

Polecenie `CREATE TABLE` sÅ‚uÅ¼y do utworzenia nowej tabeli w bazie danych.  
W tym poleceniu definiujemy nazwy kolumn, ich typy danych oraz rÃ³Å¼ne wiÄ™zy integralnoÅ›ci, takie jak `PRIMARY KEY`, `NOT NULL` czy `FOREIGN KEY`.

KaÅ¼da tabela powinna mieÄ‡ kolumnÄ™, ktÃ³ra jednoznacznie identyfikuje kaÅ¼dy wiersz â€“ to wÅ‚aÅ›nie **klucz gÅ‚Ã³wny**.

W przykÅ‚adzie poniÅ¼ej tworzymy dwie tabele: **Autorzy** i **Ksiazki**, ktÃ³re bÄ™dÄ… ze sobÄ… powiÄ…zane relacjÄ… **klucz gÅ‚Ã³wnyâ€“klucz obcy**.

---

### ğŸ’¡ PrzykÅ‚ad w **SQLite** i **PostgreSQL**

```sql
CREATE TABLE Autorzy (
    autor_id     INTEGER PRIMARY KEY,         -- w SQLite automatycznie AUTOINCREMENT
    imie         TEXT NOT NULL,
    nazwisko     TEXT NOT NULL
);

CREATE TABLE Ksiazki (
    ksiazka_id   SERIAL PRIMARY KEY,          -- PostgreSQL: automatyczna numeracja
    tytul        VARCHAR(200) NOT NULL,
    rok          INTEGER CHECK (rok > 0),
    autor_id     INTEGER,
    FOREIGN KEY (autor_id) REFERENCES Autorzy(autor_id)
);

```

- W SQLite INTEGER PRIMARY KEY = alias dla AUTOINCREMENT.
- W PostgreSQL uÅ¼ywamy SERIAL lub GENERATED ALWAYS AS IDENTITY.

W powyÅ¼szym przykÅ‚adzie:

- tabela Autorzy przechowuje dane o autorach,
- tabela Ksiazki przechowuje dane o ksiÄ…Å¼kach,
- kolumna autor_id w Ksiazki to klucz obcy, ktÃ³ry wskazuje autora.

DziÄ™ki wiÄ™zom integralnoÅ›ci baza pilnuje, by kaÅ¼da ksiÄ…Å¼ka miaÅ‚a poprawnego autora.
Takie powiÄ…zania sÄ… podstawÄ… modelu relacyjnego.


## 5ï¸âƒ£ Modyfikacja i usuwanie tabel

### ğŸ”¹ Dodawanie kolumn
```sql
ALTER TABLE Ksiazki ADD COLUMN gatunek TEXT;
```
### ğŸ”¹ Zmiana typu kolumny

```sql
ALTER TABLE STUDENT ALTER COLUMN Kierunek TYPE VARCHAR(100);
```

### ğŸ”¹ Usuwanie kolumny

```sql
ALTER TABLE STUDENT DROP COLUMN Email;
```

### ğŸ”¹ Usuwanie tabeli

```sql
DROP TABLE Ksiazki;
```



## 6ï¸âƒ£ Wstawianie danych (DML â€“ Data Manipulation Language)

Polecenie INSERT INTO sÅ‚uÅ¼y do wprowadzania nowych wierszy (rekordÃ³w) do tabeli.
WartoÅ›ci muszÄ… byÄ‡ zgodne z typami kolumn oraz ograniczeniami (NOT NULL, CHECK, itp.).

MoÅ¼na dodaÄ‡ jeden lub wiele rekordÃ³w w jednym poleceniu.

```sql
INSERT INTO Autorzy (imie, nazwisko) VALUES
('Adam', 'Mickiewicz'),
('Henryk', 'Sienkiewicz'),
('BolesÅ‚aw', 'Prus');

INSERT INTO Ksiazki (tytul, rok, autor_id) VALUES
('Pan Tadeusz', 1834, 1),
('Quo Vadis', 1896, 2),
('Lalka', 1890, 3);

```



KaÅ¼dy rekord reprezentuje jednÄ… pozycjÄ™ w tabeli.
Polecenie INSERT wymaga podania wartoÅ›ci w tej samej kolejnoÅ›ci, w jakiej wymieniono kolumny.
JeÅ›li nie podamy jakiejÅ› kolumny, a ma ona zdefiniowanÄ… wartoÅ›Ä‡ domyÅ›lnÄ… (DEFAULT), baza wstawi jÄ… automatycznie.


## 7ï¸âƒ£ Wybieranie danych â€“ SELECT

### ğŸ§© Podstawowy SELECT

```sql
SELECT * FROM Autorzy;
```
PowyÅ¼sze zapytanie zwraca wszystkich autorÃ³w z tabeli Autorzy.



### ğŸ§© WybÃ³r konkretnych kolumn
```sql

SELECT imie, nazwisko FROM Autorzy;
```

### ğŸ§© Nadawanie aliasÃ³w

```sql
SELECT imie AS "ImiÄ™", nazwisko AS "Nazwisko" FROM Autorzy;
```

Alias (AS) pozwala nadaÄ‡ kolumnom bardziej opisowe nazwy w wynikach.


## 8ï¸âƒ£ Filtrowanie â€“ WHERE

```sql
SELECT * FROM Ksiazki
WHERE rok > 1850;
```

### ğŸ§  Operatory logiczne:

- = , <>, <, >, <=, >=
- LIKE 'Q%' â†’ zaczyna siÄ™ na Q
- IN (...)
- BETWEEN 1800 AND 1900
- IS NULL, IS NOT NULL

PrzykÅ‚ad wyszukiwania ksiÄ…Å¼ek zawierajÄ…cych literÄ™ â€œaâ€ w tytule:


```sql
SELECT tytul FROM Ksiazki WHERE tytul LIKE '%a%';
```

## 9ï¸âƒ£ Sortowanie â€“ ORDER BY


```sql
SELECT * FROM Ksiazki ORDER BY rok DESC;
```

Sortowanie wynikÃ³w moÅ¼na wykonaÄ‡ wedÅ‚ug dowolnej kolumny.
DomyÅ›lnie ORDER BY sortuje rosnÄ…co (ASC).
Dla kilku kolumn moÅ¼na napisaÄ‡ np.:

```sql
SELECT * FROM Ksiazki ORDER BY autor_id ASC, rok DESC;
```

## ğŸ”Ÿ Grupowanie i agregacja â€“ GROUP BY, HAVING

```sql
SELECT autor_id, COUNT(*) AS liczba_ksiazek
FROM Ksiazki
GROUP BY autor_id
HAVING COUNT(*) > 1;

```

Klauzula GROUP BY grupuje dane, a HAVING filtruje grupy po agregacji.
Funkcje agregujÄ…ce: COUNT(), SUM(), AVG(), MIN(), MAX().



## 1ï¸âƒ£1ï¸âƒ£ ÅÄ…czenie tabel â€“ JOIN

### ğŸ”¹ INNER JOIN


```sql
SELECT k.tytul, a.imie, a.nazwisko
FROM Ksiazki k
JOIN Autorzy a ON k.autor_id = a.autor_id;
```


### ğŸ”¹ LEFT JOIN

```sql
SELECT k.tytul, a.imie, a.nazwisko
FROM Ksiazki k
LEFT JOIN Autorzy a ON k.autor_id = a.autor_id;
```

INNER JOIN zwraca tylko dopasowane rekordy,
LEFT JOIN â€“ wszystkie rekordy z lewej tabeli (nawet bez dopasowania).


## 1ï¸âƒ£2ï¸âƒ£ Aktualizacja i usuwanie danych

### ğŸ”¹ Aktualizacja danych

```sql
UPDATE Ksiazki SET rok = 1836 WHERE tytul = 'Pan Tadeusz';
```

### ğŸ”¹ Usuwanie danych

```sql
DELETE FROM Ksiazki WHERE rok < 1850;
```
Zawsze naleÅ¼y uÅ¼ywaÄ‡ WHERE, aby nie zmodyfikowaÄ‡ lub nie usunÄ…Ä‡ wszystkich rekordÃ³w.

## ğŸ§¾ Podsumowanie

SQL jest jÄ™zykiem deklaratywnym â€“ opisujemy co chcemy uzyskaÄ‡, a nie jak to zrobiÄ‡.
DziÄ™ki temu uÅ¼ytkownik nie musi znaÄ‡ szczegÃ³Å‚Ã³w dziaÅ‚ania bazy danych.

Poznane dziÅ› polecenia:

CREATE, INSERT, SELECT, UPDATE, DELETE, JOIN, GROUP BY

to fundament pracy z bazami danych.
Opanowanie ich pozwala budowaÄ‡ i analizowaÄ‡ nawet bardzo zÅ‚oÅ¼one systemy informacyjne.

â¸»

## ğŸ“š Å¹rÃ³dÅ‚a i literatura:
	â€¢	Dokumentacja SQLite
	â€¢	Dokumentacja PostgreSQL
	â€¢	A. Silberschatz, H. Korth, S. Sudarshan, Database System Concepts
