---
title: "MODEL RELACYJNY I PODSTAWY SQL"
---


## 1ï¸âƒ£ Model relacyjny â€“ przypomnienie i pojÄ™cia podstawowe

### ğŸ”¹ Relacja = tabela

- Dane przechowywane w **tabelach** (relations)
- KaÅ¼dy **wiersz (row)** = rekord / krotka  
- KaÅ¼da **kolumna (column)** = atrybut  
- **Dziedzina (domain)** = zbiÃ³r dopuszczalnych wartoÅ›ci w kolumnie

PrzykÅ‚ad relacji **STUDENT**:

| id | imie | nazwisko | rok_urodzenia |
|----|-------|------------|----------------|
| 1  | Adam  | Mickiewicz | 1798 |
| 2  | Henryk | Sienkiewicz | 1846 |


## 2ï¸âƒ£ Klucze i wiÄ™zy integralnoÅ›ci

### ğŸ”¸ Klucz gÅ‚Ã³wny (PRIMARY KEY)
- Unikalnie identyfikuje kaÅ¼dy wiersz w tabeli.
- Nie moÅ¼e byÄ‡ `NULL`.

### ğŸ”¸ Klucz obcy (FOREIGN KEY)
- OdwoÅ‚uje siÄ™ do innej tabeli (relacja miÄ™dzy tabelami).

### ğŸ”¸ Inne wiÄ™zy:
- `UNIQUE` â€“ unikalnoÅ›Ä‡ wartoÅ›ci w kolumnie.
- `NOT NULL` â€“ kolumna nie moÅ¼e mieÄ‡ wartoÅ›ci pustej.
- `CHECK` â€“ warunek logiczny na wartoÅ›Ä‡ kolumny.

| Rodzaj klucza | Opis | PrzykÅ‚ad |
|----------------|------|----------|
| **Klucz gÅ‚Ã³wny (Primary Key)** | jednoznacznie identyfikuje rekord | NrIndeksu w STUDENT |
| **Klucz obcy (Foreign Key)** | tworzy powiÄ…zanie miÄ™dzy tabelami | KursID w tabeli ZAPIS |
| **Klucz kandydujÄ…cy (Candidate Key)** | atrybut lub zestaw atrybutÃ³w, ktÃ³ry moÅ¼e peÅ‚niÄ‡ rolÄ™ klucza gÅ‚Ã³wnego | (PESEL), (NrIndeksu) |
| **Klucz zÅ‚oÅ¼ony (Composite Key)** | skÅ‚ada siÄ™ z kilku kolumn | (StudentID, KursID) |

## 2ï¸âƒ£ Rodzaje zwiÄ…zkÃ³w (relacji) miÄ™dzy tabelami

W relacyjnej bazie danych tabele mogÄ… byÄ‡ ze sobÄ… poÅ‚Ä…czone przez **klucze obce**, ktÃ³re tworzÄ… rÃ³Å¼ne typy relacji:

| Typ relacji | Opis | PrzykÅ‚ad |
|--------------|------|----------|
| **1:1 (jeden do jednego)** | jeden rekord w tabeli A odpowiada dokÅ‚adnie jednemu rekordowi w tabeli B | Student â†”ï¸ Legitymacja |
| **1:N (jeden do wielu)** | jeden rekord w tabeli A moÅ¼e byÄ‡ powiÄ…zany z wieloma rekordami w tabeli B | WykÅ‚adowca â†”ï¸ Kursy |
| **N:M (wielu do wielu)** | wiele rekordÃ³w w A moÅ¼e byÄ‡ powiÄ…zanych z wieloma w B | Studenci â†”ï¸ Kursy |

RelacjÄ™ **N:M** realizujemy przez **tabelÄ™ poÅ›redniczÄ…cÄ… (Å‚Ä…czÄ…cÄ…)**, np.:

```sql
STUDENT (NrIndeksu, Imie, Nazwisko)
KURS (KursID, Nazwa)
ZAPIS (NrIndeksu, KursID, DataZapisu)

TABELA ZAPIS zawiera klucze obce wskazujÄ…ce na STUDENT i KURS.

## 3ï¸âƒ£ Schemat bazy danych â€“ przykÅ‚ad â€Bibliotekaâ€

### Tabele:
- **Autorzy** (`autor_id`, `imie`, `nazwisko`)
- **Ksiazki** (`ksiazka_id`, `tytul`, `rok`, `autor_id`)

### Relacja:
- `Ksiazki.autor_id` $\to$ `Autorzy.autor_id` (klucz obcy)

## 4ï¸âƒ£ Wprowadzenie do jÄ™zyka SQL (Structured Query Language)

SQL to standardowy jÄ™zyk do definiowania, modyfikowania i pobierania danych w relacyjnych bazach danych.

| DDL (Data Definition Language) | definiuje strukturÄ™ bazy |CREATE TABLE, ALTER TABLE, DROP TABLE |
|---------------------------------------------------------------------------------------|
| DML (Data Manipulation Language) | operacje na danych | INSERT, UPDATE, DELETE, SELECT |
|----------------------------------------------------------------------------------------|
| DCL (Data Control Language) | kontrola dostÄ™pu | GRANT, REVOKE|
|----------------------------------------------------------------------------------------|
| TCL (Transaction Control Language) | kontrola transakcji |COMMIT, ROLLBACK |


ğŸ”¹ SkÅ‚adnia SQL â€“ podziaÅ‚ na podjÄ™zyki:

### Tworzenie tabel (DDL â€“ Data Definition Language)

Polecenie `CREATE TABLE` sÅ‚uÅ¼y do utworzenia nowej tabeli w bazie danych.  
W tym poleceniu definiujemy nazwy kolumn, ich typy danych oraz rÃ³Å¼ne wiÄ™zy integralnoÅ›ci, takie jak `PRIMARY KEY`, `NOT NULL` czy `FOREIGN KEY`.  
KaÅ¼da tabela powinna mieÄ‡ kolumnÄ™, ktÃ³ra jednoznacznie identyfikuje kaÅ¼dy wiersz â€“ to wÅ‚aÅ›nie klucz gÅ‚Ã³wny.  
W przykÅ‚adzie poniÅ¼ej tworzymy dwie tabele: **Autorzy** i **Ksiazki**, ktÃ³re bÄ™dÄ… ze sobÄ… powiÄ…zane relacjÄ… klucz gÅ‚Ã³wnyâ€“klucz obcy.



### PrzykÅ‚ad w **SQLite** i **PostgreSQL**

```sql
CREATE TABLE Autorzy (
    autor_id     INTEGER PRIMARY KEY,         -- w SQLite automatycznie AUTOINCREMENT
    imie         TEXT NOT NULL,
    nazwisko     TEXT NOT NULL
);

CREATE TABLE Ksiazki (
    ksiazka_id   SERIAL PRIMARY KEY,          -- PostgreSQL: automatyczna numeracja
    tytul        VARCHAR(200) NOT NULL,
    rok          INTEGER CHECK (rok > 0),
    autor_id     INTEGER,
    FOREIGN KEY (autor_id) REFERENCES Autorzy(autor_id)
);
```

- W SQLite INTEGER PRIMARY KEY = alias dla AUTOINCREMENT.
- W PostgreSQL SERIAL lub GENERATED ALWAYS AS IDENTITY.

W powyÅ¼szym przykÅ‚adzie tabela Autorzy przechowuje dane o autorach, a tabela Ksiazki â€“ dane o ksiÄ…Å¼kach.
Kolumna autor_id w tabeli Ksiazki jest kluczem obcym i wskazuje, ktÃ³ry autor napisaÅ‚ danÄ… ksiÄ…Å¼kÄ™.
DziÄ™ki wiÄ™zom integralnoÅ›ci baza pilnuje, aby kaÅ¼da ksiÄ…Å¼ka miaÅ‚a poprawnego autora.
Takie powiÄ…zania sÄ… podstawÄ… modelu relacyjnego.

## 5ï¸âƒ£ Modyfikacja i usuwanie tabel

### ğŸ”¹ Dodawanie kolumn

```sql
ALTER TABLE Ksiazki ADD COLUMN gatunek TEXT;
```

### ğŸ”¹ Zmiana typu kolumny

```sql
ALTER TABLE STUDENT ALTER COLUMN Kierunek TYPE VARCHAR(100);
```
### ğŸ”¹ Usuwanie kolumny

```sql
ALTER TABLE STUDENT DROP COLUMN Email;

```
### ğŸ”¹ Usuwanie tabeli
```sql
DROP TABLE Ksiazki;

```

## 6ï¸âƒ£ Wstawianie danych (DML â€“ Data Manipulation Language)

Polecenie INSERT INTO sÅ‚uÅ¼y do wprowadzania nowych wierszy (rekordÃ³w) do tabeli.
WartoÅ›ci muszÄ… byÄ‡ zgodne z typami kolumn oraz ograniczeniami (NOT NULL, CHECK, itp.).
MoÅ¼na dodaÄ‡ jeden lub wiele rekordÃ³w w jednym poleceniu.
PoniÅ¼ej wstawiamy kilku autorÃ³w oraz ich ksiÄ…Å¼ki do utworzonych wczeÅ›niej tabel.

```sql
INSERT INTO Autorzy (imie, nazwisko) VALUES
('Adam', 'Mickiewicz'),
('Henryk', 'Sienkiewicz'),
('BolesÅ‚aw', 'Prus');

INSERT INTO Ksiazki (tytul, rok, autor_id) VALUES
('Pan Tadeusz', 1834, 1),
('Quo Vadis', 1896, 2),
('Lalka', 1890, 3);
```

KaÅ¼dy rekord reprezentuje jednÄ… pozycjÄ™ w tabeli.
Polecenie INSERT wymaga podania wartoÅ›ci w tej samej kolejnoÅ›ci, w jakiej wymieniono kolumny.
JeÅ›li nie podamy jakiejÅ› kolumny, a ma ona zdefiniowanÄ… wartoÅ›Ä‡ domyÅ›lnÄ… (DEFAULT), baza wstawi jÄ… automatycznie.
DziÄ™ki temu moÅ¼emy stopniowo budowaÄ‡ zawartoÅ›Ä‡ naszej bazy danych.

## 7ï¸âƒ£ Wybieranie danych â€“ SELECT

### ğŸ§© Podstawowy SELECT

Polecenie SELECT jest najczÄ™Å›ciej uÅ¼ywanym poleceniem SQL i sÅ‚uÅ¼y do pobierania danych z tabel.
Pozwala okreÅ›liÄ‡, ktÃ³re kolumny chcemy zobaczyÄ‡ i z ktÃ³rych tabel dane majÄ… pochodziÄ‡.
JeÅ›li uÅ¼yjemy gwiazdki *, oznacza to, Å¼e wybieramy wszystkie kolumny.
PoniÅ¼sze zapytanie zwraca wszystkich autorÃ³w z tabeli Autorzy.

```sql
SELECT * FROM Autorzy;
```
### ğŸ§© WybÃ³r konkretnych kolumn

```sql
SELECT imie, nazwisko FROM Autorzy;
```

Wynik to peÅ‚na tabela z kolumnami autor_id, imie i nazwisko.
CzÄ™sto jednak potrzebujemy tylko czÄ™Å›ci danych, np. imienia i nazwiska â€“ wtedy podajemy konkretne kolumny:

### ğŸ§© Nadawanie aliasÃ³w

```sql
SELECT imie AS "ImiÄ™", nazwisko AS "Nazwisko" FROM Autorzy;
```

Takie zapytania pomagajÄ… ograniczyÄ‡ iloÅ›Ä‡ danych i zwiÄ™kszyÄ‡ czytelnoÅ›Ä‡ wynikÃ³w.
Warto teÅ¼ nadawaÄ‡ aliasy (AS), ktÃ³re pozwalajÄ… zmieniÄ‡ nazwÄ™ kolumn w wynikach i nadaÄ‡ im bardziej opisowy wyglÄ…d.


## 8ï¸âƒ£ Filtrowanie â€“ WHERE

Kiedy chcemy wybraÄ‡ tylko czÄ™Å›Ä‡ danych, uÅ¼ywamy klauzuli WHERE.
DziÄ™ki niej moÅ¼emy ustawiÄ‡ warunki, jakie muszÄ… speÅ‚niaÄ‡ rekordy, by pojawiÅ‚y siÄ™ w wyniku.
To bardzo potÄ™Å¼ne narzÄ™dzie, ktÃ³re pozwala np. wyszukiwaÄ‡ ksiÄ…Å¼ki z konkretnego roku lub autora.
W poniÅ¼szym przykÅ‚adzie wybieramy ksiÄ…Å¼ki wydane po roku 1850.


```sql
SELECT * FROM Ksiazki
WHERE rok > 1850;
```

### ğŸ§  Operatory:

MoÅ¼emy teÅ¼ stosowaÄ‡ inne operatory: 

- =, <>, <, >, <=, >=
- LIKE 'Q%' â†’ zaczyna siÄ™ na Q
- IN (...)
- BETWEEN 1800 AND 1900
- IS NULL, IS NOT NULL


Na przykÅ‚ad, aby znaleÅºÄ‡ wszystkie ksiÄ…Å¼ki, ktÃ³rych tytuÅ‚ zawiera literÄ™ â€aâ€, uÅ¼ywamy wzorca z LIKE:


```sql
SELECT tytul FROM Ksiazki WHERE tytul LIKE '%a%';
```

Klauzula WHERE pozwala wiÄ™c filtrowaÄ‡ dane na wiele sposobÃ³w, co czyni zapytania SQL bardzo elastycznymi.


## 9ï¸âƒ£ Sortowanie â€“ ORDER BY

Po pobraniu danych czÄ™sto chcemy uporzÄ…dkowaÄ‡ je wedÅ‚ug okreÅ›lonego kryterium.
Do tego sÅ‚uÅ¼y klauzula ORDER BY, dziÄ™ki ktÃ³rej moÅ¼emy sortowaÄ‡ rosnÄ…co (ASC) lub malejÄ…co (DESC).
Sortowanie dziaÅ‚a na dowolnej kolumnie, takÅ¼e tych, ktÃ³re nie sÄ… wyÅ›wietlane w wyniku.
W przykÅ‚adzie poniÅ¼ej porzÄ…dkujemy ksiÄ…Å¼ki wedÅ‚ug roku wydania od najnowszej do najstarszej.

```sql
SELECT * FROM Ksiazki ORDER BY rok DESC;
```

JeÅ›li nie podamy kierunku sortowania, domyÅ›lnie jest to ASC (rosnÄ…co).
MoÅ¼na teÅ¼ sortowaÄ‡ wedÅ‚ug kilku kolumn jednoczeÅ›nie, np. najpierw po autorze, a potem po roku.
Sortowanie poprawia czytelnoÅ›Ä‡ wynikÃ³w i pozwala szybciej analizowaÄ‡ dane.

## ğŸ”Ÿ Grupowanie i agregacja â€“ GROUP BY, HAVING

Czasem chcemy policzyÄ‡, ile danych naleÅ¼y do danej kategorii â€“ np. ilu autorÃ³w napisaÅ‚o wiÄ™cej niÅ¼ jednÄ… ksiÄ…Å¼kÄ™.
Do tego sÅ‚uÅ¼y GROUP BY, ktÃ³re grupuje dane wedÅ‚ug wybranej kolumny.
W poÅ‚Ä…czeniu z funkcjami agregujÄ…cymi, takimi jak COUNT(), AVG(), SUM(), MIN() czy MAX(), daje duÅ¼e moÅ¼liwoÅ›ci analizy.
Klauzula HAVING pozwala odfiltrowaÄ‡ grupy po obliczeniu agregacji.

```sql
SELECT autor_id, COUNT(*) AS liczba_ksiazek
FROM Ksiazki
GROUP BY autor_id
HAVING COUNT(*) > 1;
```

To zapytanie zwraca tylko tych autorÃ³w, ktÃ³rzy majÄ… wiÄ™cej niÅ¼ jednÄ… ksiÄ…Å¼kÄ™.
RÃ³Å¼nica miÄ™dzy WHERE a HAVING polega na tym, Å¼e WHERE filtruje pojedyncze wiersze przed grupowaniem, a HAVING filtruje caÅ‚e grupy po agregacji.
Wyniki moÅ¼na potem Å‚Ä…czyÄ‡ z innymi tabelami, by uzyskaÄ‡ bardziej opisowe raporty.


## 1ï¸âƒ£1ï¸âƒ£ ÅÄ…czenie tabel â€“ JOIN

W relacyjnym modelu danych informacje sÄ… rozproszone w rÃ³Å¼nych tabelach, ktÃ³re Å‚Ä…czy siÄ™ przy pomocy kluczy obcych.
Polecenie JOIN pozwala zestawiÄ‡ dane z kilku tabel na podstawie wspÃ³lnej kolumny.
NajczÄ™Å›ciej uÅ¼ywany jest INNER JOIN, ktÃ³ry zwraca tylko rekordy, dla ktÃ³rych istnieje dopasowanie w obu tabelach.
W przykÅ‚adzie Å‚Ä…czymy tabelÄ™ Ksiazki z Autorzy, aby zobaczyÄ‡ tytuÅ‚ ksiÄ…Å¼ki i jej autora.


### ğŸ”¹ INNER JOIN
```sql
SELECT k.tytul, a.imie, a.nazwisko
FROM Ksiazki k
JOIN Autorzy a ON k.autor_id = a.autor_id;
```

Wynikiem bÄ™dzie lista ksiÄ…Å¼ek wraz z imieniem i nazwiskiem autora.
JeÅ›li chcemy, aby w wynikach pojawiÅ‚y siÄ™ takÅ¼e ksiÄ…Å¼ki bez autora (lub autorzy bez ksiÄ…Å¼ek), uÅ¼ywamy odpowiednio LEFT JOIN lub RIGHT JOIN.
ÅÄ…czenie tabel to fundament relacyjnych baz danych â€“ dziÄ™ki niemu dane sÄ… spÃ³jne i nie trzeba ich powielaÄ‡.

### ğŸ”¹ LEFT JOIN
```sql
SELECT k.tytul, a.imie, a.nazwisko
FROM Ksiazki k
LEFT JOIN Autorzy a ON k.autor_id = a.autor_id;
```

## 1ï¸âƒ£2ï¸âƒ£ Aktualizacja i usuwanie danych

Polecenie UPDATE pozwala modyfikowaÄ‡ dane juÅ¼ istniejÄ…ce w tabeli.
Zawsze naleÅ¼y uÅ¼ywaÄ‡ klauzuli WHERE, aby zmiana nie objÄ™Å‚a wszystkich rekordÃ³w.
Z kolei DELETE sÅ‚uÅ¼y do usuwania rekordÃ³w â€“ rÃ³wnieÅ¼ z warunkiem, by nie usunÄ…Ä‡ wszystkiego przez pomyÅ‚kÄ™.
PrzykÅ‚ad poniÅ¼ej pokazuje, jak zmieniÄ‡ rok wydania ksiÄ…Å¼ki i usunÄ…Ä‡ starsze pozycje.

```sql
UPDATE Ksiazki SET rok = 1836 WHERE tytul = 'Pan Tadeusz';

DELETE FROM Ksiazki WHERE rok < 1850;
```

UPDATE pozwala teÅ¼ aktualizowaÄ‡ wiele kolumn naraz, a nawet wykonywaÄ‡ obliczenia.
Z kolei DELETE usuwa rekordy z tabeli, ale nie zmienia struktury bazy.
Warto zawsze testowaÄ‡ warunek WHERE wczeÅ›niej przy pomocy SELECT, by uniknÄ…Ä‡ niechcianych usuniÄ™Ä‡.


## Podsumowanie 

SQL jest jÄ™zykiem deklaratywnym â€“ opisujemy co chcemy uzyskaÄ‡, a nie jak to zrobiÄ‡.
DziÄ™ki temu uÅ¼ytkownik nie musi znaÄ‡ szczegÃ³Å‚Ã³w dziaÅ‚ania bazy danych, wystarczy, Å¼e opisze warunki i strukturÄ™ zapytania.
Poznane dziÅ› polecenia (CREATE, INSERT, SELECT, UPDATE, DELETE, JOIN, GROUP BY) to fundament pracy z bazami danych.
Opanowanie ich pozwala budowaÄ‡ i analizowaÄ‡ nawet bardzo zÅ‚oÅ¼one systemy informacyjne.

- Dokumentacja SQLite
- Dokumentacja PostgreSQL
- A. Silberschatz, H. Korth, S. Sudarshan, Database System Concepts